{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v5.json", "dbt_version": "1.7.0", "generated_at": "2025-04-29T07:25:05.629494Z", "invocation_id": "2893ef3e-4678-442d-9ccf-cda3c1b96d32", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-29T07:25:04.680859Z", "completed_at": "2025-04-29T07:25:04.693525Z"}, {"name": "execute", "started_at": "2025-04-29T07:25:04.712472Z", "completed_at": "2025-04-29T07:25:04.912817Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.2504391670227051, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.cascade_debt.analysis_a", "compiled": true, "compiled_code": "\n\nWITH an_a as (\nSELECT  EXTRACT(month FROM date_witness::date) AS month_n, f.city_agent,\n    COUNT(*) AS record_count,\n\tROW_NUMBER() OVER (PARTITION BY EXTRACT(month FROM date_witness::date) ORDER BY COUNT(*) DESC) AS row_num\nFROM dbt.filing as f\nLEFT JOIN dbt.report as r ON f.date_agent = r.date_agent AND f.agent=r.agent\nGROUP BY EXTRACT(month FROM date_witness::date), f.city_agent\nORDER BY month_n ASC, record_count DESC)\n,\nan_a2 as (\nSELECT  month_n, city_agent, record_count \nFROM an_a\nWHERE row_num=1\nORDER BY month_n\n)\n\nSELECT * FROM an_a2", "relation_name": "\"cascade_debt_db\".\"dbt\".\"answer_a\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-29T07:25:04.699424Z", "completed_at": "2025-04-29T07:25:04.759113Z"}, {"name": "execute", "started_at": "2025-04-29T07:25:04.832979Z", "completed_at": "2025-04-29T07:25:04.927513Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.2504305839538574, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.cascade_debt.analysis_c", "compiled": true, "compiled_code": "\n\nWITH an_c as (\nSELECT behavior, count(*) as ocurrences\nFROM dbt.report\nGROUP BY behavior\nORDER BY ocurrences DESC\nLIMIT 3\n)\n\nSELECT  *\nFROM an_c", "relation_name": "\"cascade_debt_db\".\"dbt\".\"answer_c\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-29T07:25:04.706163Z", "completed_at": "2025-04-29T07:25:04.739547Z"}, {"name": "execute", "started_at": "2025-04-29T07:25:04.819917Z", "completed_at": "2025-04-29T07:25:04.936999Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.25694942474365234, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.cascade_debt.analysis_d", "compiled": true, "compiled_code": "\n\nWITH an_c as (\nSELECT behavior, count(*) as ocurrences\nFROM dbt.report\nGROUP BY behavior\nORDER BY ocurrences DESC\nLIMIT 3\n),\ncommon_behavior as ( \nSELECT EXTRACT(month FROM date_witness::date) AS month_n, behavior, (case when behavior in (SELECT behavior FROM an_c) then TRUE else FALSE end) as top_behavior\nFROM dbt.report\n),\n\nan_4 as (\nSELECT month_n, count(*) as total_per_month,\nCOUNT(*) FILTER (WHERE top_behavior = TRUE) as conditional_per_month,\nROUND((COUNT(*) FILTER (WHERE top_behavior = TRUE) * 1.0) / COUNT(*), 4)  as probability\nFROM common_behavior\nGROUP BY month_n\nORDER BY month_n ASC\n)\n\nSELECT * FROM an_4", "relation_name": "\"cascade_debt_db\".\"dbt\".\"answer_d\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-29T07:25:04.694026Z", "completed_at": "2025-04-29T07:25:04.711889Z"}, {"name": "execute", "started_at": "2025-04-29T07:25:04.760519Z", "completed_at": "2025-04-29T07:25:04.954387Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.2833425998687744, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.cascade_debt.analysis_b", "compiled": true, "compiled_code": "\n\nWITH an_b as (\nSELECT  EXTRACT(month FROM date_witness::date) AS month_n,\ncount(*) as total_per_month, \nCOUNT(*) FILTER (WHERE has_weapon = TRUE and has_jacket=TRUE AND has_hat=FALSE) as conditional_per_month,\nROUND((COUNT(*) FILTER (WHERE has_weapon = TRUE and has_jacket=TRUE AND has_hat=FALSE) * 1.0) / COUNT(*), 4)  as probability\nFROM dbt.report\nGROUP BY EXTRACT(month FROM date_witness::date)\nORDER BY month_n ASC\n)\n\nSELECT  *\nFROM an_b", "relation_name": "\"cascade_debt_db\".\"dbt\".\"answer_b\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-29T07:25:04.957515Z", "completed_at": "2025-04-29T07:25:04.966196Z"}, {"name": "execute", "started_at": "2025-04-29T07:25:04.974725Z", "completed_at": "2025-04-29T07:25:05.164438Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.2215442657470703, "adapter_response": {"_message": "SELECT 958", "code": "SELECT", "rows_affected": 958}, "message": "SELECT 958", "failures": null, "unique_id": "model.cascade_debt.city_coordinates", "compiled": true, "compiled_code": "\n\n\nwith city_coordinates as (\n\n    select distinct\n        city,\n        country,\n        latitude,\n        longitude\n    from dbt.all_data\n\n)\n\nselect * from city_coordinates", "relation_name": "\"cascade_debt_db\".\"dbt\".\"city_coordinates\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-29T07:25:05.006748Z", "completed_at": "2025-04-29T07:25:05.012497Z"}, {"name": "execute", "started_at": "2025-04-29T07:25:05.022234Z", "completed_at": "2025-04-29T07:25:05.189510Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.2291700839996338, "adapter_response": {"_message": "SELECT 13582", "code": "SELECT", "rows_affected": 13582}, "message": "SELECT 13582", "failures": null, "unique_id": "model.cascade_debt.report", "compiled": true, "compiled_code": "\n\n\nwith report as (\n\n    select\n        date_witness,\n        witness,\n        date_agent,\n        agent,\n        has_weapon,\n        has_hat,\n        has_jacket,\n        behavior\n    from dbt.all_data\n\n)\n\nselect * from report", "relation_name": "\"cascade_debt_db\".\"dbt\".\"report\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-29T07:25:04.967754Z", "completed_at": "2025-04-29T07:25:05.010058Z"}, {"name": "execute", "started_at": "2025-04-29T07:25:05.014128Z", "completed_at": "2025-04-29T07:25:05.194429Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.2451925277709961, "adapter_response": {"_message": "SELECT 13582", "code": "SELECT", "rows_affected": 13582}, "message": "SELECT 13582", "failures": null, "unique_id": "model.cascade_debt.filing", "compiled": true, "compiled_code": "\n\n\nwith filing as (\n\n    select\n        date_agent,\n        agent,\n        city,\n        country,\n        city_agent\n    from dbt.all_data\n)\n\nselect * from filing", "relation_name": "\"cascade_debt_db\".\"dbt\".\"filing\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-29T07:25:05.028732Z", "completed_at": "2025-04-29T07:25:05.085817Z"}, {"name": "execute", "started_at": "2025-04-29T07:25:05.087053Z", "completed_at": "2025-04-29T07:25:05.232951Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.23038816452026367, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.cascade_debt.stg_africa", "compiled": true, "compiled_code": "\n\n\nwith africa_stg as (\n  \n  SELECT \"date_witness\" AS date_witness, \"date_agent\" AS date_agent, \"witness\" AS witness, \"agent\" AS agent, \"latitude\" AS latitude, \"longitude\" AS longitude, \"city\" AS city, \"country\" AS country, \"region_hq\" AS city_agent, \"has_weapon\" AS has_weapon, \"has_hat\" AS has_hat, \"has_jacket\" AS has_jacket, \"behavior\" AS behavior\n  FROM  dbt_raw.africa\n\n)\nselect * from africa_stg", "relation_name": "\"cascade_debt_db\".\"dbt\".\"stg_africa\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-29T07:25:05.235384Z", "completed_at": "2025-04-29T07:25:05.282522Z"}, {"name": "execute", "started_at": "2025-04-29T07:25:05.292171Z", "completed_at": "2025-04-29T07:25:05.366979Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.1487891674041748, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.cascade_debt.stg_atlantic", "compiled": true, "compiled_code": "\n\n\nwith atlantic_stg as (\n  \n  SELECT \"date_witness\" AS date_witness, \"date_agent\" AS date_agent, \"witness\" AS witness, \"agent\" AS agent, \"latitude\" AS latitude, \"longitude\" AS longitude, \"city\" AS city, \"country\" AS country, \"region_hq\" AS city_agent, \"has_weapon\" AS has_weapon, \"has_hat\" AS has_hat, \"has_jacket\" AS has_jacket, \"behavior\" AS behavior\n  FROM  dbt_raw.atlantic\n\n)\nselect * from atlantic_stg", "relation_name": "\"cascade_debt_db\".\"dbt\".\"stg_atlantic\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-29T07:25:05.197556Z", "completed_at": "2025-04-29T07:25:05.262794Z"}, {"name": "execute", "started_at": "2025-04-29T07:25:05.263853Z", "completed_at": "2025-04-29T07:25:05.368949Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.18551325798034668, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.cascade_debt.stg_america", "compiled": true, "compiled_code": "\n\n\nwith america_stg as (\n  \n  SELECT \"date_witness\" AS date_witness, \"date_agent\" AS date_agent, \"witness\" AS witness, \"agent\" AS agent, \"latitude\" AS latitude, \"longitude\" AS longitude, \"city\" AS city, \"country\" AS country, \"region_hq\" AS city_agent, \"has_weapon\" AS has_weapon, \"has_hat\" AS has_hat, \"has_jacket\" AS has_jacket, \"behavior\" AS behavior\n  FROM dbt_raw.america\n\n)\nselect * from america_stg", "relation_name": "\"cascade_debt_db\".\"dbt\".\"stg_america\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-29T07:25:05.223507Z", "completed_at": "2025-04-29T07:25:05.280840Z"}, {"name": "execute", "started_at": "2025-04-29T07:25:05.286176Z", "completed_at": "2025-04-29T07:25:05.381210Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.16748452186584473, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.cascade_debt.stg_asia", "compiled": true, "compiled_code": "\n\n\nwith asia_stg as (\n  \n  SELECT \"sighting\" AS date_witness, \"\u62a5\u9053\" AS date_agent, \"citizen\" AS witness, \"officer\" AS agent, \"\u7eac\u5ea6\" AS latitude, \"\u7ecf\u5ea6\" AS longitude, \"city\" AS city, \"nation\" AS country, \"city_interpol\" AS city_agent, \"has_weapon\" AS has_weapon, \"has_hat\" AS has_hat, \"has_jacket\" AS has_jacket, \"behavior\" AS behavior\n  FROM  dbt_raw.asia\n\n)\nselect * from asia_stg", "relation_name": "\"cascade_debt_db\".\"dbt\".\"stg_asia\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-29T07:25:05.249517Z", "completed_at": "2025-04-29T07:25:05.308982Z"}, {"name": "execute", "started_at": "2025-04-29T07:25:05.314475Z", "completed_at": "2025-04-29T07:25:05.393308Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.16028261184692383, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.cascade_debt.stg_australia", "compiled": true, "compiled_code": "\n\n\nwith australia_stg as (\n  \n  SELECT \"witnessed\" AS date_witness, \"reported\" AS date_agent, \"observer\" AS witness, \"field_chap\" AS agent, \"lat\" AS latitude, \"long\" AS longitude, \"place\" AS city, \"nation\" AS country, \"interpol_spot\" AS city_agent, \"has_weapon\" AS has_weapon, \"has_hat\" AS has_hat, \"has_jacket\" AS has_jacket, \"state_of_mind\" AS behavior\n  FROM  dbt_raw.australia\n\n)\nselect * from australia_stg", "relation_name": "\"cascade_debt_db\".\"dbt\".\"stg_australia\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-29T07:25:05.397309Z", "completed_at": "2025-04-29T07:25:05.445397Z"}, {"name": "execute", "started_at": "2025-04-29T07:25:05.446181Z", "completed_at": "2025-04-29T07:25:05.561301Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.17606806755065918, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.cascade_debt.stg_europe", "compiled": true, "compiled_code": "\n\n\nwith europe_stg as (\n  \n  SELECT \"date_witness\" AS date_witness, \"date_filed\" AS date_agent, \"witness\" AS witness, \"agent\" AS agent, \"lat_\" AS latitude, \"long_\" AS longitude, \"city\" AS city, \"country\" AS country, \"region_hq\" AS city_agent, \"armed?\" AS has_weapon, \"chapeau?\" AS has_hat, \"coat?\" AS has_jacket, \"observed_action\" AS behavior\n  FROM  dbt_raw.europe\n\n)\nselect * from europe_stg", "relation_name": "\"cascade_debt_db\".\"dbt\".\"stg_europe\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-29T07:25:05.410773Z", "completed_at": "2025-04-29T07:25:05.454911Z"}, {"name": "execute", "started_at": "2025-04-29T07:25:05.456803Z", "completed_at": "2025-04-29T07:25:05.566392Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.17367219924926758, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.cascade_debt.stg_indian", "compiled": true, "compiled_code": "\n\n\nwith indian_stg as (\n  \n  SELECT \"date_witness\" AS date_witness, \"date_agent\" AS date_agent, \"witness\" AS witness, \"agent\" AS agent, \"latitude\" AS latitude, \"longitude\" AS longitude, \"city\" AS city, \"country\" AS country, \"region_hq\" AS city_agent, \"has_weapon\" AS has_weapon, \"has_hat\" AS has_hat, \"has_jacket\" AS has_jacket, \"behavior\" AS behavior\n  FROM  dbt_raw.indian\n\n)\nselect * from indian_stg", "relation_name": "\"cascade_debt_db\".\"dbt\".\"stg_indian\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-29T07:25:05.423416Z", "completed_at": "2025-04-29T07:25:05.456372Z"}, {"name": "execute", "started_at": "2025-04-29T07:25:05.463320Z", "completed_at": "2025-04-29T07:25:05.573068Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.15615105628967285, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.cascade_debt.stg_pacific", "compiled": true, "compiled_code": "\n\n\nwith pacific_stg as (\n  \n  SELECT \"sight_on\" AS date_witness, \"file_on\" AS date_agent, \"sighter\" AS witness, \"filer\" AS agent, \"lat\" AS latitude, \"long\" AS longitude, \"town\" AS city, \"nation\" AS country, \"report_office\" AS city_agent, \"has_weapon\" AS has_weapon, \"has_hat\" AS has_hat, \"has_jacket\" AS has_jacket, \"behavior\" AS behavior\n  FROM  dbt_raw.pacific\n\n)\nselect * from pacific_stg", "relation_name": "\"cascade_debt_db\".\"dbt\".\"stg_pacific\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-29T07:25:05.579923Z", "completed_at": "2025-04-29T07:25:05.585540Z"}, {"name": "execute", "started_at": "2025-04-29T07:25:05.586282Z", "completed_at": "2025-04-29T07:25:05.616033Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.03954029083251953, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.cascade_debt.merge_all", "compiled": true, "compiled_code": "\n\nSELECT * FROM \"cascade_debt_db\".\"dbt\".\"stg_africa\"\nUNION ALL\nSELECT * FROM \"cascade_debt_db\".\"dbt\".\"stg_america\"\nUNION ALL\nSELECT * FROM \"cascade_debt_db\".\"dbt\".\"stg_asia\"\nUNION ALL\nSELECT * FROM \"cascade_debt_db\".\"dbt\".\"stg_atlantic\"\nUNION ALL\nSELECT * FROM \"cascade_debt_db\".\"dbt\".\"stg_australia\"\nUNION ALL\nSELECT * FROM \"cascade_debt_db\".\"dbt\".\"stg_europe\"\nUNION ALL\nSELECT * FROM \"cascade_debt_db\".\"dbt\".\"stg_indian\"\nUNION ALL\nSELECT * FROM \"cascade_debt_db\".\"dbt\".\"stg_pacific\"", "relation_name": "\"cascade_debt_db\".\"dbt\".\"all_data\""}], "elapsed_time": 1.0785582065582275, "args": {"log_format": "default", "show_resource_report": false, "which": "run", "printer_width": 80, "macro_debugging": false, "select": [], "populate_cache": true, "partial_parse": true, "log_level": "info", "cache_selected_only": false, "log_path": "/usr/app/dbt/logs", "strict_mode": false, "write_json": true, "introspect": true, "use_colors_file": true, "version_check": true, "log_format_file": "debug", "log_file_max_bytes": 10485760, "static_parser": true, "vars": {}, "warn_error_options": {"include": [], "exclude": []}, "log_level_file": "debug", "use_colors": true, "print": true, "send_anonymous_usage_stats": true, "indirect_selection": "eager", "favor_state": false, "profiles_dir": "/usr/app/dbt", "quiet": false, "exclude": [], "invocation_command": "dbt run", "enable_legacy_logger": false, "defer": false, "project_dir": "/usr/app/dbt", "partial_parse_file_diff": true}}